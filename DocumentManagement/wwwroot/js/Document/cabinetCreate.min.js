(function(){var n=0,t=0,i="",r;$(document).ready(function(){i=$("#EncryptedId").val();$('[data-toggle="tooltip"]').tooltip();$("#liForCabinetTree").addClass("active");$("#btnCabinetTreeMenu.arrow").addClass("open");$("#liForCabinetTree").find("ul:eq(0)").toggle(!0,"slow");c_CountId=$("#CountId").val();selectedType=1;$("#liForCabinet_"+c_CountId).addClass("active")});r=$("#divForm").kendoValidator({}).data("kendoValidator");$("#btnCreateF1").click(function(){r.validate()&&(n===0&&$("#divFolder").empty(),n++,$("#divFolder").append('<div class="row form-group f1" data-count="'+n+'" id="divF1_'+n+'"><div class="col-xs-8"><input type="text" pattern="^(?!\\s*$).?[\\w\\W]{1,}" id="f1Name_'+n+'" data-count='+n+' name="f1Name_'+n+'" required data-required-msg="*" validationMessage="*" placeholder="Master Folder Name" class="form-control" /><span class="k-widget k-invalid-msg" data-for="f1Name_'+n+'"><\/span><\/div><div class="col-xs-4">'+(n===1?"":'<button type="button" class="btn btn-primary waves-effect margin-t-r btnCancelF1" data-count='+n+' data-toggle="tooltip" title="Cancel"><i class="fa fa-times"><\/i><\/button>')+'<button type="button" class="btn btn-primary waves-effect margin-t-r btnAddF1" data-count='+n+' data-toggle="tooltip" title="Add folder"><i class="fa fa-plus"><\/i><\/button><\/div><\/div>'))});$("#divFolder").on("click",".btnAddF1",function(){r.validate()&&(n++,t=parseInt($(this).data("count")),$("#divF1_"+t).append('<div class="col-xs-12 col-xs-offset-1 m-t-10 f2" data-id="'+t+'" data-count="'+n+'" id="divF2_'+n+'"><div class="row"><div class="col-xs-8"><input type="text" pattern="^(?!\\s*$).?[\\w\\W]{1,}" id="f2Name_'+n+'" data-count='+n+' name="f2Name_'+n+'" required data-required-msg="*" validationMessage="*" placeholder="Folder name" class="form-control" /><span class="k-widget k-invalid-msg" data-for="f2Name_'+n+'"><\/span><\/div><div class="col-xs-4"><button type="button" class="btn btn-primary waves-effect margin-t-r btnCancelF2" data-count="'+n+'" data-toggle="tooltip" title="Cancel"><i class="fa fa-times"><\/i><\/button><button class="btn btn-primary waves-effect margin-t-r btnAddF2" data-count="'+n+'" data-toggle="tooltip" title="Add sub folder"><i class="fa fa-plus"><\/i><\/button><\/div><\/div><\/div>'))});$("#divFolder").on("click",".btnAddF2",function(){r.validate()&&(n++,t=parseInt($(this).data("count")),$("#divF2_"+t).append('<div class="col-xs-12 col-xs-offset-1 m-t-10 f3" data-id="'+t+'" data-count="'+n+'" id="divF3_'+n+'"><div class="row"><div class="col-xs-8"><input type="text" pattern="^(?!\\s*$).?[\\w\\W]{1,}" id="f3Name_'+n+'" data-count='+n+' name="f3Name_'+n+'" required data-required-msg="*" validationMessage="*" placeholder="Sub Folder name" class="form-control" /><span class="k-widget k-invalid-msg" data-for="f3Name_'+n+'"><\/span><\/div><div class="col-xs-4"><button type="button" class="btn btn-primary waves-effect margin-t-r btnCancelF3" data-count="'+n+'" data-toggle="tooltip" title="Cancel"><i class="fa fa-times"><\/i><\/button><\/div><\/div><\/div>'))});$("#divFolder").on("click",".btnCancelF1",function(){t=parseInt($(this).data("count"));$("#divF1_"+t).remove()});$("#divFolder").on("click",".btnCancelF2",function(){t=parseInt($(this).data("count"));$("#divF2_"+t).remove()});$("#divFolder").on("click",".btnCancelF3",function(){t=parseInt($(this).data("count"));$("#divF3_"+t).remove()});$("#btnSave").click(function(){if(n===0&&i!=="")return notification.show({message:"Please add folder."},"error"),!1;if(r.validate()){$(this).prop("disabled",!0);var u=0,f=0,s=[],e=[],o=[],h="",c="",l="";$(".f1").each(function(){e=[];u=parseInt($(this).data("count"));h=$.trim($("#f1Name_"+u).val());$(".f2").each(function(){parseInt($(this).data("id"))===u&&(o=[],f=parseInt($(this).data("count")),c=$.trim($("#f2Name_"+f).val()),$(".f3").each(function(){parseInt($(this).data("id"))===f&&(t=parseInt($(this).data("count")),l=$.trim($("#f3Name_"+t).val()),o.push({Name:l}))}),e.push({Name:c,F3Folder:o}))});s.push({Name:h,F2Folder:e})});$.ajax({url:"/Document/CabinetSave",type:"POST",data:{F1Folder:s,EncryptedId:i,CabinetName:$.trim($("#cabinetName").val())},success:function(n){n==="success"?(i===""?(notification.show({message:"Cabinet has been successfully Created."},"success"),onAjaxLoad("Cabinet","/Document/CabinetTile")):(notification.show({message:"Cabinet has been successfully updated."},"success"),onAjaxLoad("Cabinet Details","/Document/CabinetTileDetails?q="+i)),loadCabinetTree()):(i===""?notification.show({message:"Cabinet create was unsuccessful."},"error"):notification.show({message:"Cabinet update was unsuccessful."},"error"),$("#btnSave").prop("disabled",!1))},error:function(){i===""?notification.show({message:"Cabinet create was unsuccessful."},"error"):notification.show({message:"Cabinet update was unsuccessful."},"error");$("#btnSave").prop("disabled",!1)}})}});$("#btnRefresh").click(function(){i===""?onAjaxLoad("Cabinet Create","/Document/CabinetCreate"):onAjaxLoad("Cabinet Create","/Document/CabinetCreate?q="+i)});$("#btnCancel").click(function(){i===""?onAjaxLoad("Cabinet","/Document/CabinetTile"):onAjaxLoad("Cabinet Details","/Document/CabinetTileDetails?q="+i)})})();